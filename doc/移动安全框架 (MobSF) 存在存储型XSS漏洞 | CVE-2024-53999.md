#  移动安全框架 (MobSF) 存在存储型XSS漏洞 | CVE-2024-53999   
网安情报攻防站  李白你好   2024-12-05 00:01  
  
**免责声明：**由于传播、利用本公众号李白你好所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，公众号李白你好及作者不为此承担任何责任，一旦造成后果请自行承担！如有侵权烦请告知，我们会立即删除并致歉。谢谢！  
  
  
**1**►  
  
**漏洞描述**  
  
  
Mobsf允许用户上传带有 filename 参数的脚本文件。因此，恶意用户可以将脚本文件上传到系统。当应用程序中的用户使用“上传&分析”功能时，他们会受到存储型XSS的攻击。  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUD5qRoSaoMJ6LkoxmeOIgiaicPtFMAnIByqU1GzibEegUljwSf0xrESpiaLKZ6w8tjVfmGHs1lia2y85MA/640?wx_fmt=png&from=appmsg "")  
  
  
**2**►  
  
**漏洞细节**  
  
  
在“上传&分析”功能中存在存储型XSS。出现此问题的原因是上传功能允许用户上传文件名中含有特殊字符（例如 <、>、/ 和 "）的文件。可以通过将文件上传限制为仅包含白名单字符（例如 AZ、0-9）和业务要求允许的特定特殊字符（例如 - 或 _ ）的文件名来缓解此漏洞。  
  
  
1、在 MobSF 4.2.8 版本上，我点击了“上传&分析”按钮  
  
![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUD5qRoSaoMJ6LkoxmeOIgiaic1f0TgSom6Vt3EsJSBicAkjo8xlYHeXcowN4A3ibcBtagBY0IvNFe4iaaQ/640?wx_fmt=png&from=appmsg "")  
  
2、以 zip 文件作为名称上传test.zip。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUD5qRoSaoMJ6LkoxmeOIgiaicTeIwChshg0Krr38jIeGsgZKD6d0Oqb3TxJuuunYiavxWXANlA51XaHQ/640?wx_fmt=png&from=appmsg "")  
  
3、上传文件时使用了Burp将 filename 参数的值从改为test.zip。<image src onerror=prompt(document.domain)>test.zip这意味着我上传了一个文件并将其名称设置为脚本值。结果，服务器允许文件成功上传。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUD5qRoSaoMJ6LkoxmeOIgiaiciaibdwaBvDiaIfLx1lic5HB1BerzznB1KuQf3lyvaIwQY8FhesQkgCtNEw/640?wx_fmt=png&from=appmsg "")  
  
4、访问 /recent_scans/ 并找到了一个名为<image src onerror=prompt(document.domain)>test.zip“最近扫描”的文件。然后，我点击了“  
差异或比较”按钮。”  
  
![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUD5qRoSaoMJ6LkoxmeOIgiaicvLkohEHcwL9SkCkyKicfllUZF5SVbOcO76xzERqAfRibib6lEI9Kc2ib9Q/640?wx_fmt=png&from=appmsg "")  
  
5、我发现应用程序需要选择一个文件进行比较，我选择了该文件<image src onerror=prompt(document.domain)>test.zip  
  
![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUD5qRoSaoMJ6LkoxmeOIgiaic4DbNibdnCiaXxIVdm6vP2Kgu6BIzCXNGRiaTeZdWtW7jdYM8A3d9lEJpA/640?wx_fmt=png&from=appmsg "")  
  
6、  
我发现 filename 值中的 JavaScript 已在 Web 浏览器中执行。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUD5qRoSaoMJ6LkoxmeOIgiaicIj5d9kbD6XiaGArYWCtKCjBfqOP0EB6T3xnW4PDc7MSiamtE5icwRghvQ/640?wx_fmt=png&from=appmsg "")  
  
  
**3**►  
  
**漏洞危害**  
  
  
攻击者可以利用此漏洞来：  
1. 窃取敏感信息，包括会话令牌和 cookie  
  
1. 代表受害者进行未经授权的行动  
  
1. 破坏应用程序界面  
  
1. 可能与其他漏洞串联起来进一步利用  
  
该漏洞的 CVSS 基本评分为 8.1，表明严重程度较高。该  
漏洞  
影响 MobSF 的所有版本，最高版本为 4.2.8。  
  
强烈建议用户更新至 4.2.9 版本，其中包含针对此安全问题的补丁。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/XoIcX2HtlUD5qRoSaoMJ6LkoxmeOIgiaicOMzTpoLoicxKc7JxVf5ib149PRZDAaLKTicNzGY4pWeoPqiaQpzx7oL6sg/640?wx_fmt=png&from=appmsg "")  
  
  
**4**►  
  
**往期精彩**  
  
[ 记某次金融小程序数据加密及签名逆向 ](http://mp.weixin.qq.com/s?__biz=MzkwMzMwODg2Mw==&mid=2247509586&idx=1&sn=c33b1b3ce59fa2fc523f6b062df185eb&chksm=c09ad502f7ed5c14486802007f8f59ba055137028c3f0a7ebe42547647ab3059ce2a0fea5a21&scene=21#wechat_redirect)  

						  
  
  
[ 利用js挖掘漏洞 ](http://mp.weixin.qq.com/s?__biz=MzkwMzMwODg2Mw==&mid=2247509558&idx=1&sn=4ed77b8fbe43290b3fb889465673e9a3&chksm=c09ad566f7ed5c70d7aba88f9aaf96b07004f382627a0f119dd22fe51bd893d3aece18f3917f&scene=21#wechat_redirect)  

						  
  
  
[ 一款红队在信息收集时规避IP封禁的傻瓜式一键代理池，通过大量代理节点轮询的代理池工具 ](http://mp.weixin.qq.com/s?__biz=MzkwMzMwODg2Mw==&mid=2247509517&idx=1&sn=7a4576f7df6d620f072c5123107d5a86&chksm=c09ad55df7ed5c4b92e7043aa742051f8d3699ea14ad0d635f315650335e4bb77cbe9b97b38c&scene=21#wechat_redirect)  

						  
  
  
  
