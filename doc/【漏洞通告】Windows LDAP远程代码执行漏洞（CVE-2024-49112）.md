#  【漏洞通告】Windows LDAP远程代码执行漏洞（CVE-2024-49112）   
 启明星辰安全简讯   2025-01-02 10:03  
  
**一、漏洞****概述**  
<table><tbody><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;height:20.15pt;"><td width="111.33333333333333" style="border-width: 2.25pt 1.5pt 1.5pt 2.25pt;border-color: windowtext;border-style: solid;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">漏洞名称<o:p></o:p></span></p></td><td width="359.3333333333333" colspan="3" style="border-top: 2.25pt solid windowtext;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align:center;line-height:150%;"><span style="font-size: 14px;font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);">Windows LDAP远程代码执行漏洞<o:p></o:p></span></p></td></tr><tr style="mso-yfti-irow:1;height:20.15pt;"><td width="108.33333333333333" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">CVE   ID<o:p></o:p></span></p></td><td width="339.3333333333333" colspan="3" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">CVE-2024-49112<o:p></o:p></span></p></td></tr><tr style="mso-yfti-irow:2;height:20.15pt;"><td width="108.33333333333333" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">漏洞类型<o:p></o:p></span></p></td><td width="101.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: black;font-size: 14px;">整数溢出<o:p></o:p></span></p></td><td width="90.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">发现时间<o:p></o:p></span></p></td><td width="104.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">2024-12-11<o:p></o:p></span></p></td></tr><tr style="mso-yfti-irow:3;height:20.15pt;"><td width="108.33333333333333" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">漏洞评分<o:p></o:p></span></p></td><td width="111.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">9.8<o:p></o:p></span></p></td><td width="99.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">漏洞等级<o:p></o:p></span></p></td><td width="104.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;" height="20"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">高危<o:p></o:p></span></p></td></tr><tr style="mso-yfti-irow:4;"><td width="108.33333333333333" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">攻击向量<o:p></o:p></span></p></td><td width="111.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">网络<o:p></o:p></span></p></td><td width="99.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">所需权限<o:p></o:p></span></p></td><td width="104.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">无<o:p></o:p></span></p></td></tr><tr style="mso-yfti-irow:5;"><td width="108.33333333333333" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">利用难度<o:p></o:p></span></p></td><td width="111.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">低<o:p></o:p></span></p></td><td width="99.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">用户交互<o:p></o:p></span></p></td><td width="104.33333333333333" style="border-top: none;border-left: none;border-bottom: 1.5pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">无<o:p></o:p></span></p></td></tr><tr style="mso-yfti-irow:6;mso-yfti-lastrow:yes;"><td width="108.33333333333333" style="border-top: none;border-left: 2.25pt solid windowtext;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">PoC/EXP<o:p></o:p></span></p></td><td width="111.33333333333333" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">已公开<o:p></o:p></span></p></td><td width="99.33333333333333" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 1.5pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">在野利用<o:p></o:p></span></p></td><td width="104.33333333333333" style="border-top: none;border-left: none;border-bottom: 2.25pt solid windowtext;border-right: 2.25pt solid windowtext;background: rgb(222, 234, 246);padding: 0cm 5.4pt;"><p style="text-align:center;line-height:150%;"><span style="font-family: 微软雅黑, &#34;sans-serif&#34;;color: rgb(51, 51, 51);font-size: 14px;">未发现<o:p></o:p></span></p></td></tr></tbody></table>  
Windows Lightweight Directory Access Protocol
(LDAP) 是一种基于 LDAP 协议的轻量级目录访问协议，广泛用于 Windows Active
Directory (AD) 环境中，用来访问和管理目录服务信息。  
  
2025年1月2日，启明星辰集团VSRC监测到Windows Lightweight Directory Access Protocol远程代码执行漏洞（CVE-2024-49112，CVSS评分9.8）的技术细节及PoC在互联网上公开。  
  
Windows LDAP 服务的 wldap32.dll 中存在整数溢出问题，攻击者可以通过未认证的特制DCE/RPC调用（或通过其他方式）诱使目标服务器（作为 LDAP 客户端）向攻击者控制的恶意 LDAP 服务器发起查询请求，当恶意 LDAP 服务器返回特制的、恶意构造的响应时，可能触发目标服务器中的漏洞，进而导致 LSASS崩溃，引发系统重启，并可能进一步利用该漏洞导致远程代码执行。  
  
## 二、影响范围  
  
Windows 10 for x64-based Systems  
  
Windows 10 for 32-bit Systems  
  
Windows Server 2025  
  
Windows 11 Version 24H2 for x64-based Systems  
  
Windows 11 Version 24H2 for ARM64-based Systems  
  
Windows Server 2022, 23H2 Edition (Server Core
installation)  
  
Windows 11 Version 23H2 for x64-based Systems  
  
Windows 11 Version 23H2 for ARM64-based Systems  
  
Windows Server 2025 (Server Core installation)  
  
Windows 10 Version 22H2 for 32-bit Systems  
  
Windows 10 Version 22H2 for ARM64-based Systems  
  
Windows 10 Version 22H2 for x64-based Systems  
  
Windows 11 Version 22H2 for x64-based Systems  
  
Windows 11 Version 22H2 for ARM64-based Systems  
  
Windows 10 Version 21H2 for x64-based Systems  
  
Windows 10 Version 21H2 for ARM64-based Systems  
  
Windows 10 Version 21H2 for 32-bit Systems  
  
Windows Server 2022 (Server Core installation)  
  
Windows Server 2022  
  
Windows Server 2019 (Server Core installation)  
  
Windows Server 2019  
  
Windows 10 Version 1809 for x64-based Systems  
  
Windows 10 Version 1809 for 32-bit Systems  
  
Windows Server 2012 R2 (Server Core installation)  
  
Windows Server 2012 R2  
  
Windows Server 2012 (Server Core installation)  
  
Windows Server 2012  
  
Windows Server 2008 R2 for x64-based Systems
Service Pack 1 (Server Core installation)  
  
Windows Server 2008 R2 for x64-based Systems
Service Pack 1  
  
Windows Server 2008 for x64-based Systems Service
Pack 2 (Server Core installation)  
  
Windows Server 2008 for x64-based Systems Service
Pack 2  
  
Windows Server 2008 for 32-bit Systems Service Pack
2 (Server Core installation)  
  
Windows Server 2008 for 32-bit Systems Service Pack
2  
  
Windows Server 2016 (Server Core installation)  
  
Windows Server 2016  
  
Windows 10 Version 1607 for x64-based Systems  
  
Windows 10 Version 1607 for 32-bit Systems  
  
## 三、安全措施  
### 3.1 升级版本  
  
目前微软已发布该漏洞的安全更新，受影响的用户可在更新可用时及时修复。  
  
（一） Windows Update自动更新  
  
Microsoft Update默认启用，当系统检测到可用更新时，将会自动下载更新并在下一次启动时安装。也可选择通过以下步骤手动进行更新：  
  
1、点击“开始菜单”或按Windows快捷键，点击进入“设置”  
  
2、选择“更新和安全”，进入“Windows更新”（Windows 8、Windows 8.1、Windows Server 2012以及Windows Server 2012 R2可通过控制面板进入“Windows更新”，具体步骤为“控制面板”->“系统和安全”->“Windows更新”）  
  
3、选择“检查更新”，等待系统自动检查并下载可用更新。  
  
4、更新完成后重启计算机，可通过进入“Windows更新”->“查看更新历史记录”查看是否成功安装了更新。对于没有成功安装的更新，可以点击该更新名称进入微软官方更新描述链接，点击最新的SSU名称并在新链接中点击“Microsoft 更新目录”，然后在新链接中选择适用于目标系统的补丁进行下载并安装。  
  
（二） 手动安装更新  
  
Microsoft官方下载相应补丁进行更新。  
  
下载链接：  
  
https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-49112  
### 3.2 临时措施  
  
暂无。  
### 3.3 通用建议  
  
定期更新系统补丁，减少系统漏洞，提升服务器的安全性。  
  
加强系统和网络的访问控制，修改防火墙策略，关闭非必要的应用端口或服务，减少将危险服务（如SSH、RDP等）暴露到公网，减少攻击面。  
  
使用企业级安全产品，提升企业的网络安全性能。  
  
加强系统用户和权限管理，启用多因素认证机制和最小权限原则，用户和软件权限应保持在最低限度。  
  
启用强密码策略并设置为定期修改。  
### 3.4 参考链接  
  
https://www.safebreach.com/blog/ldapnightmare-safebreach-labs-publishes-first-proof-of-concept-exploit-for-cve-2024-49112/  
  
https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-49112  
  
  
  
  
